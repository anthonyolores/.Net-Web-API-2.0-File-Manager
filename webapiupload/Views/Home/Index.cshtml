<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js'></script>
<div class="row">

    <div class="col-md-6">
        <input type="file" name="client-file" id="get-files" multiple />
        <br /><br />
        <div class="fileItems-container">
            <ul id="fileItems-ul" style="list-style:none; padding:0px;"></ul>
        </div>

        <br /><br />
        <input id="fileUpload" type="file" name="files" />
        <br />
        <input id="postUpload" type="button" value="Post Upload" />
        <br /><br />
    </div>

    <div class="col-md-6" style="padding-top:0px;">
        <div class="row" style="height:300px; position:relative; background-color: #fefefe; border: 1px solid #eee; max-height:300px; overflow-y: auto;"
             ondrop="drop(event)" ondragover="allowDrop(event)">
            <div style="position:absolute; width:100%; color: #ddd; top:45%; text-align:center; font-size: 1.3em;">Drag files here to Upload </div>
            <ul style="list-style:none; padding:0px;" id="dropped-fles">

            </ul>
        </div>
        <div class="row" style="height:300px; background-color: #eee; overflow-y:auto; margin-top:15px;">
            <input id="getUploaded" type="button" value="Get Uploaded" />
            <div id="imageContainer">
            </div>
        </div>

    </div>
</div>  

<script>
    $(document).ready(function () {
        $('#getUploaded').on('click', function () {
            var ajaxRequest = $.ajax({
                type: "GET",
                url: "http://webupload.com:8084/api/FileUploads",
                success: function (data) {
                    console.log("success");
                    console.log(data);
                    var imgs = "";
                    for (var i = 0; i < data.length; i++) {
                        var src = "data:image/jpeg;base64,";
                        src += data[i].imagedata;
                        var newImage = document.createElement('img');
                        newImage.src = src;
                        newImage.width = newImage.height = "80";
                        imgs += newImage.outerHTML;
                    }
                    document.querySelector('#imageContainer').innerHTML = imgs;
                },
            });
        });
        $('#postUpload').on('click', function () {
            var data = new FormData()
            var files = $("#fileUpload").get(0).files;
            if (files.length > 0) {
                data.append("uploadedfile", files[0]);
            }
            var ajaxRequest = $.ajax({
                type: "POST",
                url: "http://webupload.com:8084/api/FileUploads",
                data: data,
                success: function (data) {
                    console.log("success");
                    console.log(data);
                },
            });
            ajaxRequest.done(function (xhr, textStatus, data) {
                console.log(data);
            });
        });
        $('#get-files').on('change', function () {
            var inp = document.getElementById("get-files");
            // Access and handle the files 

            for (i = 0; i < inp.files.length; i++) {
                let file = inp.files[i];
                $('#fileItems-ul')
                    .append('<li id="li' + i 
                    + '" style="margin:5px; display:inline-block; background-color: #eee; height:100px; width:120px;word-wrap: break-word; font-size:0.8em;  draggable="true" ondragstart="drag(event)""><span style="user-select:none;">'
                    + file.name
                    + '<br/>('
                    + file.size + ')'
                    + '</span></li>');
                console.log(file);
            }            
        });
    }); 

    function allowDrop(ev) {
        ev.preventDefault();
    }

    function drag(ev) {
        ev.dataTransfer.setData("text", ev.target.id);
    }

    function drop(ev) {
        ev.preventDefault();
        var data = ev.dataTransfer.getData("text");
        $("#dropped-fles").append(document.getElementById(data));
        //ev.target.appendChild();
    }

</script>